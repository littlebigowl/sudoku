"use strict";document.addEventListener("DOMContentLoaded",function(){function e(e,n){w.style.display="flex",R.style.display="none",N.style.display="flex",O.style.display="none",M.style.display="none",V.style.display="none",W=!0,l(),localStorage.numbersGrid&&localStorage.editableGrid&&localStorage.originalGrid&&n?localStorage.numbersGrid&&localStorage.editableGrid&&localStorage.originalGrid&&(K.numbersGrid=JSON.parse(localStorage.getItem("numbersGrid")),K.isEditableGrid=JSON.parse(localStorage.getItem("editableGrid")),K.originalGrid=JSON.parse(localStorage.getItem("originalGrid")),E(JSON.parse(localStorage.getItem("originalGrid")))):function(e){var n=S(e),t=G(n);K.originalGrid=G(n),K.numbersGrid=t,K.isEditableGrid=function(e){for(var n=0;n<9;n++)for(var t=0;t<9;t++)0==e[n][t]?e[n][t]=!0:e[n][t]=!1;return e}(n),"undefined"!=typeof localStorage?(localStorage.setItem("numbersGrid",JSON.stringify(K.numbersGrid)),localStorage.setItem("editableGrid",JSON.stringify(K.isEditableGrid)),localStorage.setItem("originalGrid",JSON.stringify(K.originalGrid))):Console.log("Sorry, I can not use your local storage, please allow it.");E(t)}(e),K.writeGridToView()}function n(){w.style.display="flex",R.style.display="none",N.style.display="none",O.style.display="flex",M.style.display="none",V.style.display="none",W=!1,K.isSolved=!1,_.innerText="Solve",l(),function(){for(var e=[],n=[],t=0;t<9;t++){e[t]=[],n[t]=[];for(var r=0;r<9;r++)n[t][r]=0,e[t][r]=!0}K.numbersGrid=n,K.isEditableGrid=e,E(n)}(),K.writeGridToView()}function t(){N.style.display="none",O.style.display="none",M.style.display="none",w.style.display="none",R.style.display="block",V.style.display="block"}function r(e){for(var n=0;n<9;n++)for(var t=0;t<9;t++){var r=document.getElementById(n+"_"+t);e[n][t]>0?r.innerText=e[n][t]:r.innerText=""}}function i(e){e.style.display="none"}function o(e){e.style.display="flex"}function l(){!function(){for(;x.firstChild;)x.removeChild(x.firstChild)}(),a(),d(F.gridDimension,F.playgroundHeight);for(var e=function(e){for(var n=function(n){var t=document.createElement("div");t.classList.add("sudokuCell"),F.canHover&&t.classList.add("canHover"),c(t,F.cellDimension),function(e,n){var t=!1;t=e>=0&&e<3||e>5&&e<9?n>=0&&n<3||n>5&&n<9:n>2&&n<6;return t}(e,n)&&t.classList.add("darkerCellBg"),t.id=e+"_"+n,x.appendChild(t),t.addEventListener("click",function(){K.clickedRow=e,K.clickedColumn=n,K.isEditableGrid[e][n]&&(!function(e,n,t){for(var r=m(e,t),i=g(n,t),o=v(e,n,t),l=f(f(r,i),o),a=1;a<10;a++){var d=document.getElementById("modalNumber_"+a);l.length>0&&l.indexOf(a)>=0||t[e][n]==a?(d.classList.remove("notClickableModalNumber"),Q.numberStateArray[a]=!0):(d.classList.add("notClickableModalNumber"),Q.numberStateArray[a]=!1)}}(e,n,K.numbersGrid),o(C))})},t=0;t<9;t++)n(t)},n=0;n<9;n++)e(n)}function a(){var e=window.innerWidth-50,n=window.innerHeight-w.offsetTop-B.clientHeight-20,t=Math.min(e,n),r=Math.floor(t/9);F.cellDimension=r,F.gridDimension=9*r,F.playgroundHeight=n}function d(e,n){x.style.width=e+"px",w.style.width=e+"px",L.style.width=e+"px",w.style.height=n+"px"}function c(e,n){e.style.width=n+"px",e.style.height=n+"px",e.style.fontSize=n<25?"10px":n<40?"20px":n<50?"28px":"40px"}function s(){for(var e=[],n=0;n<9;n++){e[n]=[];for(var t=0;t<9;t++)e[n][t]=0}for(var r=0;r<3;r++)!function(e,n,t){for(var r=e%3,i=e>6?2:e>3?1:0,o=0;o<n.length;o++)for(var l=0;l<n[o].length;l++)t[3*i+o][3*r+l]=n[o][l]}(4*r,function(){for(var e=new Array,n=[1,2,3,4,5,6,7,8,9],t=0;t<3;t++){e[t]=new Array;for(var r=0;r<3;r++){var i=Math.floor(Math.random()*n.length),o=n[i];n.splice(i,1),e[t][r]=o}}return e}(),e);return h(e),e}function u(e,n){var t=e.indexOf(n);t>-1&&e.splice(t,1)}function f(e,n){var t=e.slice(0),r=n.slice(0);return t&&r?t.filter(function(e){return r.indexOf(e)>=0}):0}function m(e,n){for(var t=[1,2,3,4,5,6,7,8,9],r=1;r<10;r++)n[e].indexOf(r)>=0&&u(t,r);return t}function g(e,n){for(var t=[1,2,3,4,5,6,7,8,9],r=0;r<9;r++)n[r][e]>0&&u(t,n[r][e]);return t}function v(e,n,t){for(var r=[1,2,3,4,5,6,7,8,9],i=e-e%3,o=n-n%3,l=i;l<i+3;l++)for(var a=o;a<o+3;a++)t[l][a]>0&&u(r,t[l][a]);return r}function y(e){for(var n=[],t=0;t<9;t++){n[t]=[];for(var r=0;r<9;r++)if(0==e[t][r]){var i=m(t,e),o=g(r,e),l=v(t,r,e),a=f(f(i,o),l);!function(e){for(var n=e.length-1;n>0;n--){var t=Math.floor(Math.random()*(n+1)),r=e[n];e[n]=e[t],e[t]=r}}(a),n[t][r]=a}else n[t][r]=0}return n}function b(e,n,t,r){return!!(function(e,n,t){return!(n[e].indexOf(t)>=0)}(e,t,r)&&function(e,n,t){for(var r=0;r<n.length;r++)if(n[r][e]==t)return!1;return!0}(n,t,r)&&function(e,n,t,r){for(var i=e-e%3,o=n-n%3,l=i;l<i+3;l++)for(var a=o;a<o+3;a++)if(t[l][a]==r)return!1;return!0}(e,n,t,r))}function h(e){p(e,y(e))}function p(e,n){for(var t=0;t<9;t++)for(var r=0;r<9;r++)if(0==e[t][r]){for(var i=n[t][r],o=0;o<i.length;o++)if(b(t,r,e,i[o])){if(e[t][r]=i[o],p(e,n))return!0;e[t][r]=0}return!1}return!0}function S(e){return function(e,n){for(var t=81-n,r=[],i=0;i<81;i++)r[i]=i;for(var o=0;o<t;o++){var l=Math.floor(Math.random()*r.length),a=r[l];r.splice(l,1);var d=function(e){return[Math.floor(e/9),e%9]}(a),c=d[0],s=d[1];e[c][s]=0}return e}(s(),e)}function G(e){for(var n=[],t=0;t<9;t++){n[t]=[];for(var r=0;r<9;r++)n[t][r]=e[t][r]}return n}function E(e){for(var n=0;n<9;n++)for(var t=0;t<9;t++)null===e[n][t]||0===e[n][t]?document.getElementById(n+"_"+t).classList.add("editableCell"):document.getElementById(n+"_"+t).classList.remove("editableCell")}function k(e,n,t,r){for(var i=0;i<9;i++)for(var o=0;o<9;o++)i<3||i>5?(o<3||o>5)&&($.beginPath(),$.fillStyle="#bfbfbf",$.rect(o*t+e,i*t+n,t,t),$.fill()):o>2&&o<6&&($.beginPath(),$.fillStyle="#bfbfbf",$.rect(o*t+e,i*t+n,t,t),$.fill()),$.beginPath(),$.rect(o*t+e,i*t+n,t,t),$.stroke(),r[i][o]>0&&function(e,n,t,r){$.beginPath(),$.font="28px Arial",$.fillStyle="black",$.textAlign="center",$.fillText(r,e+t/2,n+.75*t)}(o*t+e,i*t+n,t,r[i][o]);$.beginPath(),$.rect(e,n,9*t,9*t),$.stroke()}console.log("DOM fully loaded and parsed");var w=document.getElementById("playground-container"),I=document.getElementsByClassName("nav-item"),x=document.getElementById("playgroundGrid"),B=(document.getElementById("navbar"),document.getElementById("controls-main-container")),L=document.getElementById("control-container"),C=document.getElementById("modal-number"),N=document.getElementById("control-container-play"),O=document.getElementById("control-container-solve"),M=document.getElementById("control-container-download"),H=document.getElementById("modal-newSudoku"),T=document.getElementById("newSudoku-btn"),D=document.getElementById("newSudoku-easy"),J=document.getElementById("newSudoku-medium"),A=document.getElementById("newSudoku-hard"),P=document.getElementById("solutionSudoku-btn"),_=document.getElementById("solveSudoku-btn"),R=document.getElementById("print-container"),V=document.getElementById("printCanvas"),W=(window.innerWidth,window.innerHeight,!1),z=45,j=36,q=28,F={cellDimension:60,gridDimension:540,playgroundHeight:600,canHover:!0},K={isEditableGrid:[],numbersGrid:[],originalGrid:[],updateGridNumber:function(e){this.numbersGrid[this.clickedRow][this.clickedColumn]=e,r(this.numbersGrid)},writeGridToView:function(){r(this.numbersGrid)},clickedRow:0,clickedColumn:0,isSolved:!1},Q={numberStateArray:[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],getNumberState:function(e){return this.numberStateArray[e]}},U=void 0;window.addEventListener("resize",function(){clearTimeout(U),U=setTimeout(function(){a(),d(F.gridDimension,F.playgroundHeight);for(var e=document.getElementsByClassName("sudokuCell"),n=0;n<e.length;n++)c(e[n],F.cellDimension)},200)}),C.addEventListener("click",function(e){e.target==C&&i(C)});for(var X=function(e){document.getElementById("modalNumber_"+e).addEventListener("click",function(){Q.getNumberState(e)&&(K.updateGridNumber(e),W&&("undefined"!=typeof localStorage?(localStorage.setItem("numbersGrid",JSON.stringify(K.numbersGrid)),localStorage.setItem("editableGrid",JSON.stringify(K.isEditableGrid)),localStorage.setItem("originalGrid",JSON.stringify(K.originalGrid))):Console.log("Sorry, I can not use your local storage, please allow it.")),i(C))})},Y=0;Y<10;Y++)X(Y);T.addEventListener("click",function(){o(H)}),H.addEventListener("click",function(e){e.target==H&&i(H)}),D.addEventListener("click",function(){e(z,!1),i(H)}),J.addEventListener("click",function(){e(j,!1),i(H)}),A.addEventListener("click",function(){e(q,!1),i(H)}),P.addEventListener("click",function(){h(K.originalGrid),r(K.originalGrid),K.numbersGrid=K.originalGrid}),_.addEventListener("click",function(){K.isSolved?n():(K.isSolved=!0,h(K.numbersGrid),r(K.numbersGrid),_.innerText="New grid")}),document.addEventListener("touchstart",function(){F.canHover=!1;for(var e=document.getElementsByClassName("sudokuCell"),n=0;n<e.length;n++)e[n].classList.remove("canHover")});var Z=function(r){I[r].classList.contains("active")&&t(),I[r].addEventListener("click",function(){if(!I[r].classList.contains("active")){switch(document.getElementsByClassName("active")[0].classList.remove("active"),I[r].classList.add("active"),I[r].id){case"navPlay":e(z,!0);break;case"navSolve":n();break;case"navPrint":t()}}})};for(Y=0;Y<I.length;Y++)Z(Y);var $=V.getContext("2d");!function(e){$.beginPath(),$.fillStyle="#ffffff",$.fillRect(0,0,V.width,V.height),$.lineWidth="1",$.strokeStyle="black";var n=V.width,t=V.height,r=[];r[0]=82;var i=(t-2*r[0]-1134)/2;r[1]=r[0]+378+i,r[2]=r[0]+2*(378+i);var o=[];o[0]=85,o[1]=378+o[0]+(n-2*(378+o[0]));for(var l=0;l<2;l++)for(var a=0;a<3;a++){var d=S(e);k(o[l],r[a],42,d)}}(z)});