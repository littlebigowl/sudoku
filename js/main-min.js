"use strict";document.addEventListener("DOMContentLoaded",function(){function e(e,t){w.style.display="flex",z.style.display="none",O.style.display="flex",P.style.display="none",D.style.display="none",V.style.display="none",K=!0,o(),localStorage.numbersGrid&&localStorage.editableGrid&&localStorage.originalGrid&&t?localStorage.numbersGrid&&localStorage.editableGrid&&localStorage.originalGrid&&($.numbersGrid=JSON.parse(localStorage.getItem("numbersGrid")),$.isEditableGrid=JSON.parse(localStorage.getItem("editableGrid")),$.originalGrid=JSON.parse(localStorage.getItem("originalGrid")),S(JSON.parse(localStorage.getItem("originalGrid")))):function(e){var t=b(e),n=E(t);$.originalGrid=E(t),$.numbersGrid=n,$.isEditableGrid=function(e){for(var t=0;t<9;t++)for(var n=0;n<9;n++)0==e[t][n]?e[t][n]=!0:e[t][n]=!1;return e}(t),"undefined"!=typeof localStorage?(localStorage.setItem("numbersGrid",JSON.stringify($.numbersGrid)),localStorage.setItem("editableGrid",JSON.stringify($.isEditableGrid)),localStorage.setItem("originalGrid",JSON.stringify($.originalGrid))):Console.log("Sorry, I can not use your local storage, please allow it.");S(n)}(e),$.writeGridToView()}function t(){w.style.display="flex",z.style.display="none",O.style.display="none",P.style.display="flex",D.style.display="none",V.style.display="none",K=!1,$.isSolved=!1,_.innerText="Solve",o(),function(){for(var e=[],t=[],n=0;n<9;n++){e[n]=[],t[n]=[];for(var i=0;i<9;i++)t[n][i]=0,e[n][i]=!0}$.numbersGrid=t,$.isEditableGrid=e,S(t)}(),$.writeGridToView()}function n(e){for(var t=0;t<9;t++)for(var n=0;n<9;n++){var i=document.getElementById(t+"_"+n);e[t][n]>0?i.innerText=e[t][n]:i.innerText=""}}function i(e){e.style.display="none"}function r(e){e.style.display="flex"}function o(){!function(){for(;L.firstChild;)L.removeChild(L.firstChild)}(),l(),a(Z.gridDimension,Z.playgroundHeight);for(var e=function(e){for(var t=function(t){var n=document.createElement("div");n.classList.add("sudokuCell"),Z.canHover&&n.classList.add("canHover"),d(n,Z.cellDimension),function(e,t){var n=!1;n=e>=0&&e<3||e>5&&e<9?t>=0&&t<3||t>5&&t<9:t>2&&t<6;return n}(e,t)&&n.classList.add("darkerCellBg"),n.id=e+"_"+t,L.appendChild(n),n.addEventListener("click",function(){$.clickedRow=e,$.clickedColumn=t,$.isEditableGrid[e][t]&&(!function(e,t,n){for(var i=f(e,n),r=m(t,n),o=g(e,t,n),l=u(u(i,r),o),a=1;a<10;a++){var d=document.getElementById("modalNumber_"+a);l.length>0&&l.indexOf(a)>=0||n[e][t]==a?(d.classList.remove("notClickableModalNumber"),ee.numberStateArray[a]=!0):(d.classList.add("notClickableModalNumber"),ee.numberStateArray[a]=!1)}}(e,t,$.numbersGrid),r(N))})},n=0;n<9;n++)t(n)},t=0;t<9;t++)e(t)}function l(){var e=window.innerWidth-50,t=window.innerHeight-w.offsetTop-x.clientHeight-20,n=Math.min(e,t),i=Math.floor(n/9);Z.cellDimension=i,Z.gridDimension=9*i,Z.playgroundHeight=t}function a(e,t){L.style.width=e+"px",w.style.width=e+"px",C.style.width=e+"px",w.style.height=t+"px",z.style.height=t+"px"}function d(e,t){e.style.width=t+"px",e.style.height=t+"px",e.style.fontSize=t<25?"10px":t<40?"20px":t<50?"28px":"40px"}function s(){for(var e=[],t=0;t<9;t++){e[t]=[];for(var n=0;n<9;n++)e[t][n]=0}for(var i=0;i<3;i++)!function(e,t,n){for(var i=e%3,r=e>6?2:e>3?1:0,o=0;o<t.length;o++)for(var l=0;l<t[o].length;l++)n[3*r+o][3*i+l]=t[o][l]}(4*i,function(){for(var e=new Array,t=[1,2,3,4,5,6,7,8,9],n=0;n<3;n++){e[n]=new Array;for(var i=0;i<3;i++){var r=Math.floor(Math.random()*t.length),o=t[r];t.splice(r,1),e[n][i]=o}}return e}(),e);return p(e),e}function c(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}function u(e,t){var n=e.slice(0),i=t.slice(0);return n&&i?n.filter(function(e){return i.indexOf(e)>=0}):0}function f(e,t){for(var n=[1,2,3,4,5,6,7,8,9],i=1;i<10;i++)t[e].indexOf(i)>=0&&c(n,i);return n}function m(e,t){for(var n=[1,2,3,4,5,6,7,8,9],i=0;i<9;i++)t[i][e]>0&&c(n,t[i][e]);return n}function g(e,t,n){for(var i=[1,2,3,4,5,6,7,8,9],r=e-e%3,o=t-t%3,l=r;l<r+3;l++)for(var a=o;a<o+3;a++)n[l][a]>0&&c(i,n[l][a]);return i}function y(e){for(var t=[],n=0;n<9;n++){t[n]=[];for(var i=0;i<9;i++)if(0==e[n][i]){var r=f(n,e),o=m(i,e),l=g(n,i,e),a=u(u(r,o),l);!function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[n],e[n]=i}}(a),t[n][i]=a}else t[n][i]=0}return t}function v(e,t,n,i){return!!(function(e,t,n){return!(t[e].indexOf(n)>=0)}(e,n,i)&&function(e,t,n){for(var i=0;i<t.length;i++)if(t[i][e]==n)return!1;return!0}(t,n,i)&&function(e,t,n,i){for(var r=e-e%3,o=t-t%3,l=r;l<r+3;l++)for(var a=o;a<o+3;a++)if(n[l][a]==i)return!1;return!0}(e,t,n,i))}function p(e){return h(e,y(e))}function h(e,t){for(var n=0;n<9;n++)for(var i=0;i<9;i++)if(0==e[n][i]){for(var r=t[n][i],o=0;o<r.length;o++)if(v(n,i,e,r[o])){if(e[n][i]=r[o],h(e,t))return!0;e[n][i]=0}return!1}return!0}function b(e){return function(e,t){for(var n=81-t,i=[],r=0;r<81;r++)i[r]=r;for(var o=0;o<n;o++){var l=Math.floor(Math.random()*i.length),a=i[l];i.splice(l,1);var d=function(e){return[Math.floor(e/9),e%9]}(a),s=d[0],c=d[1];e[s][c]=0}return e}(s(),e)}function E(e){for(var t=[],n=0;n<9;n++){t[n]=[];for(var i=0;i<9;i++)t[n][i]=e[n][i]}return t}function S(e){for(var t=0;t<9;t++)for(var n=0;n<9;n++)null===e[t][n]||0===e[t][n]?document.getElementById(t+"_"+n).classList.add("editableCell"):document.getElementById(t+"_"+n).classList.remove("editableCell")}function G(e,t,n,i){for(var r=0;r<9;r++)for(var o=0;o<9;o++)r<3||r>5?(o<3||o>5)&&(oe.beginPath(),oe.fillStyle="#bfbfbf",oe.rect(o*n+e,r*n+t,n,n),oe.fill()):o>2&&o<6&&(oe.beginPath(),oe.fillStyle="#bfbfbf",oe.rect(o*n+e,r*n+t,n,n),oe.fill()),oe.beginPath(),oe.rect(o*n+e,r*n+t,n,n),oe.stroke(),i[r][o]>0&&function(e,t,n,i){oe.beginPath(),oe.font="28px Arial",oe.fillStyle="black",oe.textAlign="center",oe.fillText(i,e+n/2,t+.75*n)}(o*n+e,r*n+t,n,i[r][o]);oe.beginPath(),oe.rect(e,t,9*n,9*n),oe.stroke()}function I(e){oe.clearRect(0,0,V.width,V.height),oe.beginPath(),oe.fillStyle="#ffffff",oe.fillRect(0,0,V.width,V.height),oe.lineWidth="1",oe.strokeStyle="black";var t=V.width,n=V.height,i=[];i[0]=82;var r=(n-2*i[0]-1134)/2;i[1]=i[0]+378+r,i[2]=i[0]+2*(378+r);var o=[];o[0]=85,o[1]=378+o[0]+(t-2*(378+o[0]));for(var l=0;l<2;l++)for(var a=0;a<3;a++){var d=b(e);G(o[l],i[a],42,d)}}function k(){for(var e=document.getElementsByClassName("print-options-diff"),t=0;t<e.length;t++)e[t].classList.remove("print-active")}console.log("DOM fully loaded and parsed");var w=document.getElementById("playground-container"),B=document.getElementsByClassName("nav-item"),L=document.getElementById("playgroundGrid"),x=(document.getElementById("navbar"),document.getElementById("controls-main-container")),C=document.getElementById("control-container"),N=document.getElementById("modal-number"),O=document.getElementById("control-container-play"),P=document.getElementById("control-container-solve"),D=document.getElementById("control-container-download"),M=document.getElementById("modal-newSudoku"),H=document.getElementById("newSudoku-btn"),T=document.getElementById("newSudoku-easy"),J=document.getElementById("newSudoku-medium"),A=document.getElementById("newSudoku-hard"),R=document.getElementById("solutionSudoku-btn"),_=document.getElementById("solveSudoku-btn"),z=document.getElementById("print-container"),V=document.getElementById("printCanvas"),W=document.getElementById("printLoader"),j=document.getElementById("noSolutionNote"),F=document.getElementById("printDifficultyEasy"),U=document.getElementById("printDifficultyMedium"),q=document.getElementById("printDifficultyHard"),K=(document.getElementById("numberOfPages1"),document.getElementById("numberOfPages3"),document.getElementById("numberOfPages5"),document.getElementById("numberOfPages10"),document.getElementById("numberOfPages25"),window.innerWidth,window.innerHeight,!1),Q=45,X=36,Y=28,Z={cellDimension:60,gridDimension:540,playgroundHeight:600,canHover:!0},$={isEditableGrid:[],numbersGrid:[],originalGrid:[],updateGridNumber:function(e){this.numbersGrid[this.clickedRow][this.clickedColumn]=e,n(this.numbersGrid)},writeGridToView:function(){n(this.numbersGrid)},clickedRow:0,clickedColumn:0,isSolved:!1},ee={numberStateArray:[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],getNumberState:function(e){return this.numberStateArray[e]}},te=void 0;window.addEventListener("resize",function(){clearTimeout(te),te=setTimeout(function(){l(),a(Z.gridDimension,Z.playgroundHeight);for(var e=document.getElementsByClassName("sudokuCell"),t=0;t<e.length;t++)d(e[t],Z.cellDimension)},200)}),N.addEventListener("click",function(e){e.target==N&&i(N)});for(var ne=function(e){document.getElementById("modalNumber_"+e).addEventListener("click",function(){ee.getNumberState(e)&&($.updateGridNumber(e),K&&("undefined"!=typeof localStorage?(localStorage.setItem("numbersGrid",JSON.stringify($.numbersGrid)),localStorage.setItem("editableGrid",JSON.stringify($.isEditableGrid)),localStorage.setItem("originalGrid",JSON.stringify($.originalGrid))):Console.log("Sorry, I can not use your local storage, please allow it.")),i(N))})},ie=0;ie<10;ie++)ne(ie);H.addEventListener("click",function(){r(M)}),M.addEventListener("click",function(e){e.target==M&&i(M)}),T.addEventListener("click",function(){e(Q,!1),i(M)}),J.addEventListener("click",function(){e(X,!1),i(M)}),A.addEventListener("click",function(){e(Y,!1),i(M)}),R.addEventListener("click",function(){p($.originalGrid)&&(n($.originalGrid),$.numbersGrid=$.originalGrid)}),_.addEventListener("click",function(){if($.isSolved)t();else{p($.numbersGrid)?($.isSolved=!0,n($.numbersGrid),_.innerText="New grid"):(j.style.display="flex",setTimeout(function(){j.style.display="none"},2e3))}}),document.addEventListener("touchstart",function(){Z.canHover=!1;for(var e=document.getElementsByClassName("sudokuCell"),t=0;t<e.length;t++)e[t].classList.remove("canHover")});var re=function(n){B[n].classList.contains("active")&&e(Q,!0),B[n].addEventListener("click",function(){if(!B[n].classList.contains("active")){switch(document.getElementsByClassName("active")[0].classList.remove("active"),B[n].classList.add("active"),B[n].id){case"navPlay":e(Q,!0);break;case"navSolve":t();break;case"navPrint":z.style.display="block",O.style.display="none",P.style.display="none",D.style.display="flex",w.style.display="none"}}})};for(ie=0;ie<B.length;ie++)re(ie);var oe=V.getContext("2d");oe.beginPath(),oe.fillStyle="#ffffff",oe.fillRect(0,0,V.width,V.height);var le=1,ae=Q;F.addEventListener("click",function(){k(),F.classList.add("print-active"),ae=Q}),U.addEventListener("click",function(){k(),U.classList.add("print-active"),ae=X}),q.addEventListener("click",function(){k(),q.classList.add("print-active"),ae=Y});var de=document.getElementsByClassName("print-options-num"),se=function(e){de[e].addEventListener("click",function(t){var n=de[e].id.split("_"),i=parseInt(n[1]);le=i,function(){for(var e=document.getElementsByClassName("print-options-num"),t=0;t<e.length;t++)e[t].classList.remove("print-active")}(),de[e].classList.add("print-active")})};for(ie=0;ie<de.length;ie++)se(ie);D.addEventListener("click",function(){W.style.display="flex",setTimeout(function(){for(var e=new jsPDF,t=e.internal.pageSize.width,n=e.internal.pageSize.height,i=0;i<le;i++){I(ae);var r=V.toDataURL("image/jpeg",1);e.addImage(r,"JPEG",0,0,t,n),i+1!==le&&e.addPage()}W.style.display="none",e.save("sudoku.pdf")},30)})});